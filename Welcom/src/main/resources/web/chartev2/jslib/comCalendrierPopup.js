les_jours=new Array();les_mois=new Array();les_annees=new Object();function Arguments(o,m,a,ad,af,f,l){if(m==null){d=new Date();m=d.getMonth()+1;};if(a==null){d=new Date();a=d.getFullYear();};if(ad==null){d=new Date();ad=d.getFullYear()-3;};if(af==null){d=new Date();af=d.getFullYear()+3;};this.objet=o;this.mois=m;this.annee=a;this.anneeDebut=ad;this.anneeFin=af;this.format=f;if(l!=null){this.langue=l.substring(0,2);}else{this.langue="fr";};inclureDico(this.langue+".js");this.les_jours=les_jours;this.les_mois=les_mois;this.les_annees=les_annees;};function afficherCalendrier(page,o,m,a,ad,af,f,l){var arguments=new Arguments(o,m,a,ad,af,f,l);if(screen.width>1279){window.showModalDialog(page,arguments,"dialogWidth:212px; dialogHeight:220px; scroll:no; help:no; status:no")}else{window.showModalDialog(page,arguments,"dialogWidth:212px; dialogHeight:190px; scroll:no; help:no; status:no")};};var objet,mois,annee,format,langue,anneeDebut,anneeFin,tableJours;function fabriquerCalendrier(){objet=window.dialogArguments.objet;mois=window.dialogArguments.mois;annee=window.dialogArguments.annee;format=window.dialogArguments.format;langue=window.dialogArguments.langue;anneeDebut=window.dialogArguments.anneeDebut;anneeFin=window.dialogArguments.anneeFin;les_jours=window.dialogArguments.les_jours;les_mois=window.dialogArguments.les_mois;les_annees=window.dialogArguments.les_annees;tableJours=new Array(42);var tmpObj=document.all.tableCalendrier,tmpLigne,tmpCellule,x,y,i=0;for(y=1;y<7;y++){tmpLigne=tmpObj.rows(y);for(x=0;x<7;x++){tableJours[i]=tmpLigne.cells(x);i++;};};var option;for(var i=0;i<7;i++){document.all.tableCalendrier.rows(0).cells(i).innerText=les_jours[i];};for(i=anneeDebut;i<anneeFin+1;i++){option=document.createElement("OPTION");option.text=les_annees["pre"]+i+les_annees["post"];option.value=i;document.all.listeAnnees.add(option);};for(i=1;i<13;i++){option=document.createElement("OPTION");option.text=les_mois[i-1];option.value=i;document.all.listeMois.add(option);};document.all.listeMois.value=mois;document.all.listeAnnees.value=annee;rafraichirCalendrier();};function rafraichirCalendrier(){var premierJour=premierJourDuMois(mois,annee),nombreDeJours=nombreDeJoursDuMois(mois,annee),Tmp="",now=new Date(),JourJ=now.getDate(),month=now.getMonth(),year=now.getYear();if(year<999)year+=1900;var tmpTD;for(i=0;i<premierJour;i++){tmpTD=tableJours[i];tmpTD.innerText="";tmpTD.onmouseover="";tmpTD.onmouseout="";tmpTD.onclick="";tmpTD.className="nodate";};for(i=0;i<nombreDeJours;i++){tmpTD=tableJours[i+premierJour];if((JourJ==(i+1))&&(document.forms[0].listeMois.options[document.forms[0].listeMois.selectedIndex].value==(month+1))&&(document.forms[0].listeAnnees.options[document.forms[0].listeAnnees.selectedIndex].value==(year))){tmpTD.innerHTML="<b>"+(i+1)+"</b>";}else{tmpTD.innerHTML=(i+1);};tmpTD.onmouseover=function(){this.className="dateover"};tmpTD.onmouseout=function(){this.className="date"};tmpTD.onclick=function(){fermerCalendrier(this.innerText)};try{tmpTD.style.cursor="pointer";}catch(e){tmpTD.style.cursor="hand";};tmpTD.className="date";};for(i=nombreDeJours+premierJour;i<42;i++){tmpTD=tableJours[i];tmpTD.innerText="";tmpTD.onmouseover="";tmpTD.onmouseout="";tmpTD.onclick="";tmpTD.className="nodate";};};function fermerCalendrier(j){var chaineDate=formaterDate(j,mois,annee);objet.value=chaineDate;window.close();};function formaterDate(_j,_m,_a){var retour=format;if(retour==null){retour="dd/MM/yyyy";}else if(retour=="mm/jj/aaaa"){retour="MM/dd/yyyy";};var j=(_j<10)?"0"+_j:_j,m=(_m<10)?"0"+_m:_m,a2=_a+"",a2=a2.substring(a2.length-2,a2.length);retour=retour.replace(/dd/g,j);retour=retour.replace(/d/g,_j);retour=retour.replace(/MM/g,m);retour=retour.replace(/M/g,_m);retour=retour.replace(/yyyy/g,_a);retour=retour.replace(/yy/g,a2);return(retour);};function nombreDeJoursDuMois(m,a){if(m==1||m==3||m==5||m==7||m==8||m==10||m==12){return(31);}else if(m==4||m==6||m==9||m==11){return(30);}else{var test=a-1900;if((test==100)||(test%4==0&&test%100!=0)||(test%400==0)){return(29);}else{return(28);};};};function premierJourDuMois(m,a){var premierJour=new Date(a,m-1,1),reponse=premierJour.getDay()-1;if(reponse==-1){reponse=6;};return(reponse);};function inclureDico(dico){var s=document.getElementsByTagName("script"),ln=s.length,chemin=null;for(var i=0;i<ln;i++){if(s[i].src.indexOf("comCalendrierPopup.js")!=-1){chemin=s[i].src.substring(0,s[i].src.lastIndexOf("/")+1);break;};};if(chemin==null){alert("comCalendrierPopup.js introuvable\nVous ne devez pas renommer comCalendrierPopup.js!");};var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.type="text/javascript";script.src=chemin+dico;head.appendChild(script);};
